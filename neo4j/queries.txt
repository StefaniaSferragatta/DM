// query 1 
// match given drug - gene
MATCH (g:Gene)-[:alteration]->(p:Drug)
WHERE p.name = 'Ponatinib' 
return g.name;

// query 2
// Return all gene names together with the number
// of drugs associated
match (g)-[:alteration]->(d)
return g.name, count(distinct d)

// Return all gene names together with the number
// of sample in which are overexpressed
match (g)-[:is_overexpressed]->(s)
return g.name, count(distinct s) as num_samples

// query 3
// Top 5 genes per number of drugs associated 
match (g)-[:alteration]->(d)
with count(*) AS num_drug, g
return g.name, num_drug
order by num_drug desc
limit 5

// query 4
// Find a sample given a drug
MATCH (node1:Gene)-[:is_overexpressed]->(node2:Sample)
WHERE EXISTS ((node1)-[:alteration]->(:Drug {name: 'Ponatinib'}))
return node2.name as sample_id

// path
MATCH path = ((node1:Gene)-[:is_overexpressed]->(node2:Sample))
WHERE EXISTS ((node1)-[:alteration]->(:Drug {name: 'Ponatinib'}))
return path

// query 5
MATCH path = ((d)<-[:alteration]-(g:Gene)-[:is_overexpressed]->(s))
WHERE d.name = 'Dabrafenib'
return path, g.name;

// query 6
// Given a sample, cisualize the drugs associated to the oncogene genes
match (node2 {name: 'TCGA-B5-A5OE-01A-11R-A31O-07'})<-[:is_overexpressed]-(node1 {is_oncogene: '1'})-[:alteration]->(node3)
return node1,node2,node3

// Find tumor suppressor genes that are overexpressed in at least 5 types of cancer
match (g:Gene {is_tumor_suppressor: '1'})-[:is_overexpressed]->(node2) 
with count(distinct node2.cancer) as num_cancer, g
where num_cancer > 5
return distinct(g.name) as gene_id, num_cancer

// Given a sample ID, return a list of overexpressed gene and possible type of alterations
CALL {
    MATCH (node1:Gene)-[r:alteration]->(node2:Drug)
    return node1
    UNION
    MATCH (node1:Gene)-[:is_overexpressed]->(node2:Sample {name: 'TCGA-B5-A5OE-01A-11R-A31O-07'})
    return node1
}
WITH node1,[(node1)-[r: alteration]->(node2) |  r.name] AS alterations_name
UNWIND alterations_name as alt_name
RETURN node1.name as gene_id, collect(distinct alt_name)

// Find the sample which has the greates number of associated drugs and its list
MATCH (b)<-[:is_overexpressed]-(a)-[:alteration]->(c)
RETURN b.name as sample_id, COLLECT(distinct c.name) as drugs
ORDER BY SIZE(drugs) DESC LIMIT 1

// Visualize the sample and the related gene that is oncogene and whose alteration is 'Oncogenic Mutations'
CALL {
Match (g)-[:alteration {name : 'Oncogenic Mutations'}]->(:Drug)
return g
}
with g, (g {is_oncogene:'1'})-[:is_overexpressed]->(:Sample) as list_sample
UNWIND list_sample as sample
return distinct sample
